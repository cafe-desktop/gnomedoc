<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:set="http://exslt.org/sets" xmlns:str="http://exslt.org/strings">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Custom Widgets</title>
<link rel="previous" href="sec-custom-containers.html.en.html" title="Custom Containers">
<link rel="next" href="chapter-multi-threaded-programs.html.en.html" title="Multi-threaded programs">
<link rel="top" href="index.html.en.html" title="Programming with gtkmm 4">
<style type="text/css">

html { height: 100%; }
body {
  margin: 0px; padding: 12px;
  background-color: #f9f9f6;
  min-height: 100%;
  direction: ltr;
}
div, p, pre, blockquote { margin: 0; padding: 0; }
p img { vertical-align: middle; }
sub { font-size: 0.83em; }
sub sub { font-size: 1em; }
sup { font-size: 0.83em; }
sup sup { font-size: 1em; }
table { border-collapse: collapse; }
table.table-pgwide { width: 100%; }
td { vertical-align: top; }
td { padding: 0.2em 0.83em 0.2em 0.83em; }
th { padding: 0 0.83em 0 0.83em; }
tr.tr-shade {
  background-color: #f9f9f6;
}
td.td-colsep { border-right: solid 1px; }
td.td-rowsep { border-bottom: solid 1px; }
thead { border-top: solid 2px; border-bottom: solid 2px; }
tfoot { border-top: solid 2px; border-bottom: solid 2px; }
div.body {
  padding: 1em;
  max-width: 60em;
  background-color: #ffffff;
  border: solid 1px #e0e0df;
}
div.body-sidebar {
  margin-right: 13em;
}
div.division div.division { margin-top: 1.72em; }
div.division div.division div.division { margin-top: 1.44em; }
div.header {
  margin: 0;
  color: #3f3f3f;
  border-bottom: solid 1px #e0e0df;
}
h1, h2, h3, h4, h5, h6, h7 {
  margin: 0; padding: 0;
  color: #3f3f3f;
}
h1.title { font-size: 1.72em; }
h2.title { font-size: 1.44em; }
h3.title { font-size: 1.2em; }
h4.title, h5.title, h6.title, h7.title { font-size: 1em; }
.block { margin-top: 1em; }
.block .block-first { margin-top: 0; }
.block-indent {
  margin-left left: 1.72em;
  margin-: 1em;
}
.block-indent .block-indent { margin-left: 0em; margin-right: 0em; }
td .block-indent  { margin-left: 0em; margin-right: 0em; }
dd .block-indent  { margin-left: 0em; margin-right: 0em; }
.block-verbatim { white-space: pre; }
div.title {
  margin-bottom: 0.2em;
  font-weight: bold;
  color: #3f3f3f;
}
div.title-formal { padding-left: 0.2em; padding-right: 0.2em; }
div.title-formal .label { font-weight: normal; }
a {
  color: #1f609f;
  text-decoration: none;
}
a:hover { text-decoration: underline; }
a:visited { color: #9f1f6f; }
ul, ol, dl { margin: 0; padding: 0; }
li {
  margin-top: 1em;
  margin-left: 2.4em;
  padding: 0;
}
li.li-first { margin-top: 0; }
dt { margin: 1em 0 0 0; }
dt.dt-first { margin: 0; }
dd {
  margin-left: 1.72em;
  margin-top: 0.5em;
}
dl.dl-compact dt { margin-top: 0; }
dl.dl-compact dd { margin-top: 0; margin-bottom: 0; }


ul.linktrail {
  display: block;
  margin: 0.2em 0 0 0;
  text-align: right;
}
li.linktrail { display: inline; margin: 0; padding: 0; }

li.linktrail::before {
  content: '  /  ';
  color: #3f3f3f;
}

li.linktrail-first::before, li.linktrail-only::before { content: ''; }


div.navbar {
  padding: 0.5em 1em 0.5em 1em;
  max-width: 60em;
  background-color: #ffffff;
  border: solid 1px #e0e0df;
}
div.navbar-top { margin-bottom: 1em; }
div.navbar-bottom { margin-top: 1em; clear: both; }
div.navbar img { border: 0; vertical-align: -0.4em; }
table.navbar { width: 100%; margin: 0; border: none; }
table.navbar td { padding: 0; border: none; }
td.navbar-next {
  text-align: right;
}
a.navbar-prev::before {
  
  content: '◀  ';
  color: #3f3f3f;
}
a.navbar-next::after {
  
  content: '  ▶';
  color: #3f3f3f;
}


div.sidebar {
  float: right;
  padding: 0; margin: 0; width: 12em;
}
div.sidenav {
  padding: 0.5em 1em 0 1em;
  background-color: #ffffff;
  border: solid 1px #e0e0df;
}
div.sidenav div.autotoc {
  background-color: #ffffff;
  border: none; padding: 0; margin: 0;
}
div.sidenav div.autotoc div.autotoc { margin-top: 0.5em; }
div.sidenav div.autotoc li { margin-bottom: 0.5em; }
div.sidenav div.autotoc div.autotoc div.autotoc {
  margin-left: 1em;
  margin-top: 0;
}
div.sidenav div.autotoc div.autotoc div.autotoc li { margin-bottom: 0; }


div.autotoc {
  
  display: table;
  margin-top: 1em;
  margin-left: 1.72em;
  padding: 0.5em 1em 0.5em 1em;
  background-color: #f0f9ff;
  border: solid 1px #c0c9ff;
}
div.autotoc ul { margin: 0; padding: 0; }
div.autotoc li { list-style-type: none; margin: 0; }
div.autotoc div.autotoc-title { margin-bottom: 0.5em; }
div.autotoc div.autotoc { border: none; padding: 0; margin-top: 0; margin-bottom: 0.5em; }
div.autotoc div.autotoc div.autotoc { margin-bottom: 0; }


span.bibliolabel {
  color: #3f3f3f;
}


div.admonition {
  padding: 0.5em 6px 0.5em 6px;
  border: solid 1px #e0e0df;
  background-color: #fffff0;
}
div.caution-inner, div.important-inner, div.note-inner, div.tip-inner, div.warning-inner {
  padding-left: 60px;
  background-position: left top;
  background-repeat: no-repeat;
  min-height: 48px;
}
div.caution-inner { background-image: url("../../skin/admon-caution.png"); }
div.important-inner { background-image: url("../../skin/admon-important.png"); }
div.note-inner { background-image: url("../../skin/admon-note.png"); }
div.note-bug div.note-inner { background-image: url("../../skin/admon-bug.png"); }
div.tip-inner { background-image: url("../../skin/admon-tip.png"); }
div.warning-inner { background-image: url("../../skin/admon-warning.png"); }
div.blockquote {
  
  background-image: url('https://developer-old.gnome.org/gtkmm-tutorial/stable/watermark-blockquote-201C.png');
  background-repeat: no-repeat;
  background-position: top left;
  padding: 0.5em;
  padding-left: 4em;
}
div.attribution {
  margin-top: 0.5em;
  color: #3f3f3f;
}
div.attribution::before {
  
  content: '― ';
}
div.epigraph {
  text-align: right;
  margin-left: 20%;
  margin-right: 0;
  color: #3f3f3f;
}
div.figure, div.informalfigure {
  
  display: table;
  padding: 0.5em;
  background-color: #f9f9f6;
  border: solid 1px #e0e0df;
}
div.figure-inner, div.informalfigure-inner {
  padding: 0.5em;
  background-color: #ffffff;
  border: solid 1px #e0e0df;
}
div.caption { margin-top: 0.5em; }
div.programlisting {
  padding: 0.5em;
  
  background-color: #f9f9f6;
  border: solid 1px #e0e0df;
}
div.screen {
  padding: 0.5em;
  
  background-color: #f9f9f6;
  border: solid 1px #e0e0df;
}
div.screen .prompt {
  color: #3f3f3f;
}
div.screen .userinput {
  font-weight: bold;
  color: #3f3f3f;
}
div.programlisting .userinput {
  font-weight: bold;
  color: #3f3f3f;
}
pre.linenumbering {
  color: #3f3f3f;
  margin: 0;
  padding-right: 1em;
  float: left;
  text-align: right;
}



dl.index dt { margin-top: 0; }
dl.index dd { margin-top: 0; margin-bottom: 0; }
dl.indexdiv dt { margin-top: 0; }
dl.indexdiv dd { margin-top: 0; margin-bottom: 0; }
dl.setindex dt { margin-top: 0; }
dl.setindex dd { margin-top: 0; margin-bottom: 0; }
div.list div.title-formal span.title {
  border-bottom: solid 1px #e0e0df;
}
div.simplelist {
  margin-left: 1.72em;
}
div.simplelist table { margin-left: 0; border: none; }
div.simplelist td {
  padding: 0.5em;
  border-left: solid 1px #e0e0df;
}
div.simplelist td.td-first {
  padding-left: 0;
  border-left: 0;
}
div.synopsis {
  padding: 0.5em;
  
  background-color: #f9f9f6;
  border-top: solid 2px #c0c9ff;
  border-bottom: solid 2px #c0c9ff;
}
div.synopsis div.synopsis {
  padding: 0;
  border: none;
}
div.synopsis div.block { margin-top: 0.2em; }
div.synopsis div.block-first { margin-top: 0; }
div.cmdsynopsis { font-family: monospace; }

span.accel { text-decoration: underline; }
span.acronym { font-family: sans-serif; }
span.application { font-style: italic; }
span.classname, span.exceptionname, span.interfacename { font-family: monospace; }
span.code {
  font-family: monospace;
  border: solid 1px #e0e0df;
  padding-left: 0.2em;
  padding-right: 0.2em;
}
pre span.code { border: none; padding: 0; }
span.command {
  font-family: monospace;
  border: solid 1px #e0e0df;
  padding-left: 0.2em;
  padding-right: 0.2em;
}
pre span.command { border: none; padding: 0; }
span.computeroutput { font-family: monospace; }

span.constant { font-family: monospace; }
span.database { font-family: monospace; }
span.email { font-family: monospace; }
span.emphasis { font-style: italic; }
span.emphasis-bold { font-style: normal; font-weight: bold; }
span.envar { font-family: monospace; }

span.filename { font-family: monospace; }
span.firstterm { font-style: italic; }
span.foreignphrase { font-style: italic; }
span.function { font-family: monospace; }

dt.glossterm span.glossterm { font-style: normal; }


span.glossterm { font-style: italic; }

span.guibutton, span.guilabel, span.guimenu, span.guimenuitem, span.guisubmenu, span.interface {
  font-weight: bold;
  color: #3f3f3f;
}
span.keycap {
  font-weight: bold;
  color: #3f3f3f;
}
span.lineannotation { font-style: italic; }
span.literal { font-family: monospace; }
span.markup  { font-family: monospace; }
span.medialabel { font-style: italic; }
span.methodname { font-family: monospace; }
span.ooclass, span.ooexception, span.oointerface { font-family: monospace; }
span.option { font-family: monospace; }
span.package { font-family: monospace; }
span.parameter { font-family: monospace; }
span.paramdef span.parameter { font-style: italic; }
span.prompt { font-family: monospace; }
span.property { font-family: monospace; }
span.replaceable  { font-style: italic; }
span.returnvalue { font-family: monospace; }
span.sgmltag { font-family: monospace; }
span.structfield, span.structname { font-family: monospace; }
span.symbol { font-family: monospace; }
span.systemitem { font-family: monospace; }
span.token { font-family: monospace; }
span.type { font-family: monospace; }
span.uri { font-family: monospace; }
span.userinput { font-family: monospace; }
span.varname { font-family: monospace; }
span.wordasword { font-style: italic; }



div.footnotes { font-style: italic; font-size: 0.8em; }
div.footnote { margin-top: 1.44em; }
span.footnote-number { display: inline; padding-right: 0.83em; }
span.footnote-number + p { display: inline; }
a.footnote { text-decoration: none; font-size: 0.8em; }
a.footnote-ref { text-decoration: none; }

span.co {
  margin-left: 0.2em; margin-right: 0.2em;
  padding-left: 0.4em; padding-right: 0.4em;
  border: solid 1px #000000;
  -moz-border-radius: 8px;
  background-color: #000000;
  color: #FFFFFF;
  font-size: 8px;
}
span.co:hover {
  border-color: #333333;
  background-color: #333333;
  color: #FFFFFF;
}
span.co a { text-decoration: none; }
span.co a:hover { text-decoration: none; }

dt.question { margin-left: 0em; }
dt.question div.label { float: left; }
dd + dt.question { margin-top: 1em; }
dd.answer {
  margin-top: 1em;
  margin-left: 2em;
  margin-right: 1em;
}
dd.answer div.label { float: left; }
</style>
<link rel="stylesheet" type="text/css" media="all" href="https://static.gnome.org/css/grass-theme-style.css">
<link rel="stylesheet" type="text/css" media="all" href="../../skin/lgo2010.css">
<link rel="icon" type="image/png" href="../../skin/gnome-16.png">
<link rel="SHORTCUT ICON" type="image/png" href="../../skin/gnome-16.png">
<link rel="search" type="application/opensearchdescription+xml" href="../../gnome-library-search.xml" title="GNOME Library Search">
<link rel="stylesheet" type="text/css" href="../../skin/jquery.autocomplete.css">
<script type="text/javascript" src="../../js/jquery.js"></script><script type="text/javascript" src="../../js/jquery.autocomplete.js"></script><script type="text/javascript" src="../../js/jquery.js"></script>
</head>
<body>
<div id="accessibility_access"><ul>
<li><a href="sec-custom-widgets.html.en.html#container">Go to page content</a></li>
<li><a href="sec-custom-widgets.html.en.html#top_bar">Go to main menu</a></li>
<li><a href="sec-custom-widgets.html.en.html#s" onclick="$('#s').focus(); return false;">Go to the search field</a></li>
</ul></div>
<div id="global_domain_bar"><div class="maxwidth"><div class="tab"><a class="root" href="https://www.gnome.org/">GNOME.org</a></div></div></div>
<div id="header" class="container_12">
<div id="logo" class="grid_3"><a title="Go to home page" href="../../index.html"><img alt="GNOME: The Free Software Desktop Project" src="../../skin/gnome-logo-devcenter.png"></a></div>
<div id="top_bar" class="grid_9">
<div class="left"><div class="menu-globalnav-container"><ul id="menu-globalnav" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-6"><a href="../../about/index.html">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-23"><a href="https://help.gnome.org/users/">Users</a></li>
<li class="menu-item menu-item-type-post_type menu-item-40"><a href="https://help.gnome.org/admin/">Administrators</a></li>
<li class="current-menu-item"><a href="https://developer.gnome.org/">Developers</a></li>
</ul></div></div>
<div class="right">
<form role="search" method="get" id="searchform" action="https://developer-old.gnome.org/symbols/"><div>
<label class="hidden" for="q">Search:
                        </label><input type="text" value="" name="q" id="s" placeholder="Search">
</div></form>
<script type="text/javascript">
$('#s').autocomplete('/symbols/lookup/',
        { minChars:3, matchSubset:1, matchContains:1, cacheLength:10,
          selectOnly:1, rowsLimit:25 });
              </script>
</div>
</div>
</div>
<div class="clearfix"></div>
<div id="container" class="two_columns">
<div class="content">
<div class="division sect1">
<a name="sec-custom-widgets"><!--sec-custom-widgets--></a><div class="header"><h1 class="sect1 title"><span class="title">Custom Widgets</span></h1></div>
<ul class="linktrail">
<li class="linktrail linktrail-first"><a class="linktrail" href="index.html.en.html" title="Programming with gtkmm 4">Programming with <span class="application">gtkmm</span> 4</a></li>
<li class="linktrail linktrail-last"><a class="linktrail" href="chapter-customwidgets.html.en.html" title="Custom Widgets">Custom Widgets</a></li>
</ul>
<p class="para block block-first">By deriving directly from <span class="classname" dir="ltr">Gtk::Widget</span> you can
        do all the drawing for your widget directly, instead of just arranging
        child widgets. For instance, a <span class="classname" dir="ltr">Gtk::Label</span> draws
        the text of the label, but does not do this by using other
        widgets.</p>
<p class="para block">When deriving from <span class="classname" dir="ltr">Gtk::Widget</span>, you should
        override the following virtual methods. The methods marked (optional)
        need not be overridden in all custom widgets. The base class's methods
        may be appropriate.
    <div class="block list itemizedlist"><ul class="itemizedlist">
<li class="li-first"><span class="para"><span class="methodname" dir="ltr">get_request_mode_vfunc()</span>: (optional) Return what <span class="literal" dir="ltr">Gtk::SizeRequestMode</span> is preferred by the widget.</span></li>
<li><span class="para"><span class="methodname" dir="ltr">measure_vfunc()</span>: Calculate the minimum and natural width or height of the widget.</span></li>
<li><span class="para"><span class="methodname" dir="ltr">on_size_allocate()</span>: Position the widget, given the height and width that it has actually been given.</span></li>
<li><span class="para"><span class="methodname" dir="ltr">on_realize()</span>: Associate a <span class="classname" dir="ltr">Gdk::Surface</span> with the widget.</span></li>
<li><span class="para"><span class="methodname" dir="ltr">on_unrealize()</span>: (optional) Break the association with the <span class="classname" dir="ltr">Gdk::Surface</span>. </span></li>
<li><span class="para"><span class="methodname" dir="ltr">on_map()</span>: (optional)</span></li>
<li><span class="para"><span class="methodname" dir="ltr">on_unmap()</span>: (optional)</span></li>
<li><span class="para"><span class="methodname" dir="ltr">snapshot_vfunc()</span>: Create a render node, e.g. a <span class="classname" dir="ltr">Cairo::Context</span> node, and draw on it.</span></li>
</ul></div>
    </p>
<p class="para block">The first 3 methods in the previous table are also overridden in custom
        containers. They are briefly described in the
        <a class="link" href="sec-custom-containers.html.en.html" title="Custom Containers">Custom Containers</a> section.
    </p>
<div class="autotoc"><ul>
<li>
<span class="label">26.2.1. </span><a class="xref" href="sec-custom-widgets.html.en.html#custom-init-functions" title="Class Init and Instance Init Functions">Class Init and Instance Init Functions</a>
</li>
<li>
<span class="label">26.2.2. </span><a class="xref" href="sec-custom-widgets.html.en.html#custom-style-information" title="Custom Style Information">Custom Style Information</a>
</li>
<li>
<span class="label">26.2.3. </span><a class="xref" href="sec-custom-widgets.html.en.html#custom-widget-example" title="Example">Example</a>
</li>
</ul></div>
<div class="division sect2">
<a name="custom-init-functions"><!--custom-init-functions--></a><div class="header"><h2 class="sect2 title"><span class="title"><span class="label">26.2.1. </span>Class Init and Instance Init Functions</span></h2></div>
<p class="para block block-first">Some <span class="application">GTK</span> functions, if called at all, must be
called from the class init function. Some other <span class="application">GTK</span>
functions, if called, must be called from the instance init function.
If your custom widget must call any of those functions, you can derive a class
from <span class="classname" dir="ltr">Glib::ExtraClassInit</span> and derive your custom class
from that class. The following example shows how that's done.</p>
</div>
<div class="division sect2">
<a name="custom-style-information"><!--custom-style-information--></a><div class="header"><h2 class="sect2 title"><span class="title"><span class="label">26.2.2. </span>Custom Style Information</span></h2></div>
<p class="para block block-first">Your widget class, whether it's derived directly from
<span class="classname" dir="ltr">Gtk::Widget</span> or from another widget class,
can read some style information from a CSS (Cascading Style Sheets) file. The users
of your widget, or the users of an application program with your widget, can then
modify the style of your widget without modifying the source code. Useful classes
are <span class="classname" dir="ltr">Gtk::StyleContext</span> and <span class="classname" dir="ltr">Gtk::CssProvider</span>.
With the methods of <span class="classname" dir="ltr">Gtk::StyleContext</span> you can read the values
of your widget's style information. CSS files are described in the documentation of
<span class="application">GTK</span>. The following example shows a simple use of
<span class="methodname" dir="ltr">Gtk::StyleContext::get_padding()</span>.</p>
</div>
<div class="division sect2">
<a name="custom-widget-example"><!--custom-widget-example--></a><div class="header"><h2 class="sect2 title"><span class="title"><span class="label">26.2.3. </span>Example</span></h2></div>
<p class="para block block-first">This example implements a widget which draws Penrose triangles.</p>
<div class=" block figure block-indent">
<a name="figure-custom-widget"><!--figure-custom-widget--></a><div class="block block-first title title-formal"><span class="title"><span class="label"><span style="font-style: italic; ">Figure 26-2</span> </span>Custom Widget</span></div>
<div class="figure-inner">
  
  <div class=" block screenshot block-first">
    <div class="graphic"><img src="figures/custom_widget.png.en"></div>
  </div>
</div>
</div>
<p class="para block"><a class="ulink" href="https://gitlab.gnome.org/GNOME/gtkmm-documentation/tree/master/examples/book/custom/custom_widget/" title="https://gitlab.gnome.org/GNOME/gtkmm-documentation/tree/master/examples/book/custom/custom_widget/">Source Code</a></p>
<p class="para block">File: <span class="filename" dir="ltr">examplewindow.h</span> (For use with gtkmm 4)</p>
<div dir="ltr" class=" block programlisting block-indent"><pre class="programlisting">#ifndef GTKMM_EXAMPLEWINDOW_H
#define GTKMM_EXAMPLEWINDOW_H

#include &lt;gtkmm.h&gt;
#include "mywidget.h"

class ExampleWindow : public Gtk::Window
{
public:
  ExampleWindow();
  virtual ~ExampleWindow();

protected:
  //Signal handlers:
  void on_button_quit();

  //Child widgets:
  Gtk::Grid m_Grid;
  MyWidget m_MyWidgetS1;
  MyWidget m_MyWidgetS2;
  Gtk::Box m_ButtonBox;
  Gtk::Button m_Button_Quit;
};

#endif //GTKMM_EXAMPLEWINDOW_H
</pre></div>
<p class="para block">File: <span class="filename" dir="ltr">mywidget.h</span> (For use with gtkmm 4)</p>
<div dir="ltr" class=" block programlisting block-indent"><pre class="programlisting">#ifndef GTKMM_CUSTOM_WIDGET_MYWIDGET_H
#define GTKMM_CUSTOM_WIDGET_MYWIDGET_H

#include &lt;gtkmm/widget.h&gt;
#include &lt;gtkmm/cssprovider.h&gt;
#include "myextrainit.h"

class MyWidget
:
public MyExtraInit,
public Gtk::Widget
{
public:
  MyWidget();
  virtual ~MyWidget();

protected:

  //Overrides:
  Gtk::SizeRequestMode get_request_mode_vfunc() const override;
  void measure_vfunc(Gtk::Orientation orientation, int for_size, int&amp; minimum, int&amp; natural,
    int&amp; minimum_baseline, int&amp; natural_baseline) const override;
  void on_map() override;
  void on_unmap() override;
  void on_realize() override;
  void on_unrealize() override;
  void snapshot_vfunc(const Glib::RefPtr&lt;Gtk::Snapshot&gt;&amp; snapshot) override;

  //Signal handler:
  void on_parsing_error(const Glib::RefPtr&lt;const Gtk::CssSection&gt;&amp; section, const Glib::Error&amp; error);

  Gtk::Border m_padding;
  Glib::RefPtr&lt;Gtk::CssProvider&gt; m_refCssProvider;
};

#endif //GTKMM_CUSTOM_WIDGET_MYWIDGET_H
</pre></div>
<p class="para block">File: <span class="filename" dir="ltr">myextrainit.h</span> (For use with gtkmm 4)</p>
<div dir="ltr" class=" block programlisting block-indent"><pre class="programlisting">#ifndef GTKMM_CUSTOM_WIDGET_MYEXTRAINIT_H
#define GTKMM_CUSTOM_WIDGET_MYEXTRAINIT_H

#include &lt;glibmm/extraclassinit.h&gt;
#include &lt;glibmm/ustring.h&gt;

// Calls gtk_widget_class_set_css_name() in the class init function
// and gtk_set_has_window() in the instance init function.
class MyExtraInit : public Glib::ExtraClassInit
{
public:
  MyExtraInit(const Glib::ustring&amp; css_name);

private:
  Glib::ustring m_css_name;
};

#endif //GTKMM_CUSTOM_WIDGET_MYEXTRAINIT_H
</pre></div>
<p class="para block">File: <span class="filename" dir="ltr">main.cc</span> (For use with gtkmm 4)</p>
<div dir="ltr" class=" block programlisting block-indent"><pre class="programlisting">#include "examplewindow.h"
#include &lt;gtkmm/application.h&gt;

int main(int argc, char *argv[])
{
  auto app = Gtk::Application::create("org.gtkmm.example");

  //Shows the window and returns when it is closed.
  return app-&gt;make_window_and_run&lt;ExampleWindow&gt;(argc, argv);
}
</pre></div>
<p class="para block">File: <span class="filename" dir="ltr">examplewindow.cc</span> (For use with gtkmm 4)</p>
<div dir="ltr" class=" block programlisting block-indent"><pre class="programlisting">#include "examplewindow.h"

ExampleWindow::ExampleWindow()
: m_Button_Quit("Quit")
{
  set_title("Custom Widget example");
  set_default_size(600, 400);

  m_Grid.set_margin(6);
  m_Grid.set_row_spacing(10);
  m_Grid.set_column_spacing(10);

  set_child(m_Grid);

  m_Grid.attach(m_MyWidgetS1, 0, 0);
  m_Grid.attach(m_MyWidgetS2, 1, 1);

  m_Grid.attach(m_ButtonBox, 0, 2, 2, 1);

  m_ButtonBox.append(m_Button_Quit);
  m_ButtonBox.set_margin(6);
  m_Button_Quit.set_hexpand(true);
  m_Button_Quit.set_halign(Gtk::Align::END);
  m_Button_Quit.signal_clicked().connect( sigc::mem_fun(*this, &amp;ExampleWindow::on_button_quit) );
}

ExampleWindow::~ExampleWindow()
{
}

void ExampleWindow::on_button_quit()
{
  hide();
}
</pre></div>
<p class="para block">File: <span class="filename" dir="ltr">myextrainit.cc</span> (For use with gtkmm 4)</p>
<div dir="ltr" class=" block programlisting block-indent"><pre class="programlisting">#include "myextrainit.h"
#include &lt;gtkmm/widget.h&gt;
#include &lt;gtk/gtk.h&gt;

namespace
{
using BaseObjectType = GtkWidget;
using BaseClassType = GtkWidgetClass;

// Extra class init function.
void class_init_function(void* g_class, void* class_data)
{
  g_return_if_fail(GTK_IS_WIDGET_CLASS(g_class));

  const auto klass = static_cast&lt;BaseClassType*&gt;(g_class);
  const auto css_name = static_cast&lt;Glib::ustring*&gt;(class_data);

  gtk_widget_class_set_css_name(klass, css_name-&gt;c_str());
}

// Extra instance init function.
void instance_init_function(GTypeInstance* instance, void* /* g_class */)
{
  g_return_if_fail(GTK_IS_WIDGET(instance));

  // Nothing to do here.
  // This extra instance init function just shows how such a function can
  // be added to a custom widget, if necessary.
}

} // anonymous namespace

MyExtraInit::MyExtraInit(const Glib::ustring&amp; css_name)
:
Glib::ExtraClassInit(class_init_function, &amp;m_css_name, instance_init_function),
m_css_name(css_name)
{
}
</pre></div>
<p class="para block">File: <span class="filename" dir="ltr">mywidget.cc</span> (For use with gtkmm 4)</p>
<div dir="ltr" class=" block programlisting block-indent"><pre class="programlisting">#include "mywidget.h"
#include &lt;gdkmm/general.h&gt;  // for cairo helper functions
#include &lt;gtkmm/snapshot.h&gt;
#include &lt;iostream&gt;
//#include &lt;gtk/gtkwidget.h&gt; //For GTK_IS_WIDGET()
#include &lt;cstring&gt;


MyWidget::MyWidget() :
  //The GType name will actually be gtkmm__CustomObject_MyWidget
  Glib::ObjectBase("MyWidget"),
  MyExtraInit("my-widget"), // CSS node name, which must be used in the CSS file.
  Gtk::Widget(),
  m_padding()
{
  // Expand, if there is extra space.
  set_expand(true);

  //This shows the GType name.
  std::cout &lt;&lt; "GType name: " &lt;&lt; G_OBJECT_TYPE_NAME(gobj()) &lt;&lt; std::endl;

  //This shows that the GType still derives from GtkWidget:
  //std::cout &lt;&lt; "Gtype is a GtkWidget?:" &lt;&lt; GTK_IS_WIDGET(gobj()) &lt;&lt; std::endl;

  // The CSS name can be set either
  // - for a GType (in this case for your custom class) with gtk_widget_class_set_css_name(), or
  // - for a widget instance with gtk_widget_set_name() (Gtk::Widget::set_name()).
  //
  // gtk_widget_class_set_css_name(), if used, must be called in the class init function.
  // It has not been wrapped in a C++ function.
  // Gtk::Widget::set_name() can be called in a C++ constructor.
  //
  // Another alternative: The custom widget inherits the CSS name "widget" from
  // GtkWidget. That name can be used in the CSS file. This is not a very good
  // alternative. GtkWidget's CSS name is not documented. It can probably be
  // changed or removed in the future.

  m_refCssProvider = Gtk::CssProvider::create();
  auto refStyleContext = get_style_context();
  refStyleContext-&gt;add_provider(m_refCssProvider,
    GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);
  m_refCssProvider-&gt;signal_parsing_error().connect(
    sigc::mem_fun(*this, &amp;MyWidget::on_parsing_error));

  m_refCssProvider-&gt;load_from_path("custom_gtk.css");
}

MyWidget::~MyWidget()
{
}

Gtk::SizeRequestMode MyWidget::get_request_mode_vfunc() const
{
  //Accept the default value supplied by the base class.
  return Gtk::Widget::get_request_mode_vfunc();
}

//Discover the total amount of minimum space and natural space needed by
//this widget.
//Let's make this simple example widget always need minimum 60 by 50 and
//natural 100 by 70.
void MyWidget::measure_vfunc(Gtk::Orientation orientation, int /* for_size */,
  int&amp; minimum, int&amp; natural, int&amp; minimum_baseline, int&amp; natural_baseline) const
{
  if (orientation == Gtk::Orientation::HORIZONTAL)
  {
    minimum = 60;
    natural = 100;
  }
  else
  {
    minimum = 50;
    natural = 70;
  }

  // Don't use baseline alignment.
  minimum_baseline = -1;
  natural_baseline = -1;
}

void MyWidget::on_map()
{
  //Call base class:
  Gtk::Widget::on_map();
}

void MyWidget::on_unmap()
{
  //Call base class:
  Gtk::Widget::on_unmap();
}

void MyWidget::on_realize()
{
  //Get the themed padding from the CSS file:
  m_padding = get_style_context()-&gt;get_padding();
  std::cout &lt;&lt; "m_padding from the theme/css-file is"
    &lt;&lt; ": top=" &lt;&lt; m_padding.get_top()
    &lt;&lt; ", right=" &lt;&lt; m_padding.get_right()
    &lt;&lt; ", bottom=" &lt;&lt; m_padding.get_bottom()
    &lt;&lt; ", left=" &lt;&lt; m_padding.get_left() &lt;&lt; std::endl;

  //Call base class:
  Gtk::Widget::on_realize();
}

void MyWidget::on_unrealize()
{
  //Call base class:
  Gtk::Widget::on_unrealize();
}

void MyWidget::snapshot_vfunc(const Glib::RefPtr&lt;Gtk::Snapshot&gt;&amp; snapshot)
{
  const auto allocation = get_allocation();
  const Gdk::Rectangle rect(0, 0, allocation.get_width(), allocation.get_height());
  auto refStyleContext = get_style_context();

  // Create a cairo context to draw on.
  auto cr = snapshot-&gt;append_cairo(rect);

  // paint the background
  refStyleContext-&gt;render_background(cr,
    -m_padding.get_left(), -m_padding.get_top(), allocation.get_width(), allocation.get_height());

  // draw the foreground
  const double scale_x = 0.001 * (allocation.get_width() - m_padding.get_left() - m_padding.get_right());
  const double scale_y = 0.001 * (allocation.get_height() - m_padding.get_top() - m_padding.get_bottom());
  Gdk::Cairo::set_source_rgba(cr, refStyleContext-&gt;get_color());
  cr-&gt;rectangle(0.0, 0.0, 1000.0*scale_x, 1000.0*scale_y);
  cr-&gt;move_to(155.*scale_x, 165.*scale_y);
  cr-&gt;line_to(155.*scale_x, 838.*scale_y);
  cr-&gt;line_to(265.*scale_x, 900.*scale_y);
  cr-&gt;line_to(849.*scale_x, 564.*scale_y);
  cr-&gt;line_to(849.*scale_x, 438.*scale_y);
  cr-&gt;line_to(265.*scale_x, 100.*scale_y);
  cr-&gt;line_to(155.*scale_x, 165.*scale_y);
  cr-&gt;move_to(265.*scale_x, 100.*scale_y);
  cr-&gt;line_to(265.*scale_x, 652.*scale_y);
  cr-&gt;line_to(526.*scale_x, 502.*scale_y);
  cr-&gt;move_to(369.*scale_x, 411.*scale_y);
  cr-&gt;line_to(633.*scale_x, 564.*scale_y);
  cr-&gt;move_to(369.*scale_x, 286.*scale_y);
  cr-&gt;line_to(369.*scale_x, 592.*scale_y);
  cr-&gt;move_to(369.*scale_x, 286.*scale_y);
  cr-&gt;line_to(849.*scale_x, 564.*scale_y);
  cr-&gt;move_to(633.*scale_x, 564.*scale_y);
  cr-&gt;line_to(155.*scale_x, 838.*scale_y);
  cr-&gt;stroke();
}

void MyWidget::on_parsing_error(const Glib::RefPtr&lt;const Gtk::CssSection&gt;&amp; section, const Glib::Error&amp; error)
{
  std::cerr &lt;&lt; "on_parsing_error(): " &lt;&lt; error.what() &lt;&lt; std::endl;
  if (section)
  {
    const auto file = section-&gt;get_file();
    if (file)
    {
      std::cerr &lt;&lt; "  URI = " &lt;&lt; file-&gt;get_uri() &lt;&lt; std::endl;
    }

    auto start_location = section-&gt;get_start_location();
    auto end_location = section-&gt;get_end_location();
    std::cerr &lt;&lt; "  start_line = " &lt;&lt; start_location.get_lines()+1
              &lt;&lt; ", end_line = " &lt;&lt; end_location.get_lines()+1 &lt;&lt; std::endl;
    std::cerr &lt;&lt; "  start_position = " &lt;&lt; start_location.get_line_chars()
              &lt;&lt; ", end_position = " &lt;&lt; end_location.get_line_chars() &lt;&lt; std::endl;
  }
}
</pre></div>
<p class="para block">File: <span class="filename" dir="ltr">custom_gtk.css</span> (For use with gtkmm 4)</p>
<div dir="ltr" class=" block programlisting block-indent"><pre class="programlisting">/* Example of a CSS style sheet. */

my-widget {
  background-color: rgb(255,0,0);
  color:            rgb(0,0,255);
  padding:          10px 15px 20px 5px; /* top right bottom left */
}
</pre></div>
</div>
</div>
<div class="navbar navbar-bottom"><table class="navbar"><tr>
<td class="navbar-prev"><a class="navbar-prev" href="sec-custom-containers.html.en.html" title="Custom Containers">Custom Containers</a></td>
<td class="navbar-next"><a class="navbar-next" href="chapter-multi-threaded-programs.html.en.html" title="Multi-threaded programs">Multi-threaded programs</a></td>
</tr></table></div>
<div class="docbook-legal-stuff">
<h3 onclick="$(this).next().toggle()">About</h3>
<div style="display: none;"></div>
</div>
</div>
<div class="sidebar"><div class="sidenav"><div class="autotoc"><ul>
<li><a href="index-info.html.en.html" title="About This Document">About This Document</a></li>
<li>
<a class="xref" href="index.html.en.html" title="Programming with gtkmm 4">Programming with <span class="application">gtkmm</span> 4</a><div class="autotoc"><ul>
<li><a class="xref" href="chapter-introduction.html.en.html" title="Introduction">Introduction</a></li>
<li><a class="xref" href="chapter-installation.html.en.html" title="Installation">Installation</a></li>
<li><a class="xref" href="chapter-basics.html.en.html" title="Basics">Basics</a></li>
<li><a class="xref" href="changes-gtkmm3.html.en.html" title="Changes in gtkmm 3">Changes in <span class="application">gtkmm</span> 3</a></li>
<li><a class="xref" href="changes-gtkmm4.html.en.html" title="Changes in gtkmm-4.0 and glibmm-2.68">Changes in <span class="application">gtkmm</span>-4.0 and <span class="application">glibmm-2.68</span></a></li>
<li><a class="xref" href="chapter-button-widget.html.en.html" title="Buttons">Buttons</a></li>
<li><a class="xref" href="chapter-range-widgets.html.en.html" title="Range Widgets">Range Widgets</a></li>
<li><a class="xref" href="chapter-misc-widgets.html.en.html" title="Miscellaneous Widgets">Miscellaneous Widgets</a></li>
<li><a class="xref" href="chapter-container-widgets.html.en.html" title="Container Widgets">Container Widgets</a></li>
<li><a class="xref" href="chapter-treeview.html.en.html" title="The TreeView widget">The TreeView widget</a></li>
<li><a class="xref" href="chapter-combobox.html.en.html" title="Combo Boxes">Combo Boxes</a></li>
<li><a class="xref" href="chapter-textview.html.en.html" title="TextView">TextView</a></li>
<li><a class="xref" href="chapter-menus-and-toolbars.html.en.html" title="Menus and Toolbars">Menus and Toolbars</a></li>
<li><a class="xref" href="chapter-adjustment.html.en.html" title="Adjustments">Adjustments</a></li>
<li><a class="xref" href="chapter-dialogs.html.en.html" title="Dialogs">Dialogs</a></li>
<li><a class="xref" href="chapter-drawingarea.html.en.html" title="The DrawingArea Widget">The DrawingArea Widget</a></li>
<li><a class="xref" href="chapter-draganddrop.html.en.html" title="Drag and Drop">Drag and Drop</a></li>
<li><a class="xref" href="chapter-clipboard.html.en.html" title="The Clipboard">The Clipboard</a></li>
<li><a class="xref" href="chapter-printing.html.en.html" title="Printing">Printing</a></li>
<li><a class="xref" href="chapter-recent-documents.html.en.html" title="Recently Used Documents">Recently Used Documents</a></li>
<li><a class="xref" href="chapter-keyboardevents.html.en.html" title="Keyboard Events">Keyboard Events</a></li>
<li><a class="xref" href="chapter-chapter-timeouts.html.en.html" title="Timeouts, I/O and Idle Functions ">Timeouts, I/O and Idle Functions </a></li>
<li><a class="xref" href="chapter-memory.html.en.html" title="Memory management">Memory management</a></li>
<li><a class="xref" href="chapter-builder.html.en.html" title="Glade and Gtk::Builder">Glade and Gtk::Builder</a></li>
<li><a class="xref" href="chapter-internationalization.html.en.html" title="Internationalization and Localization">Internationalization and Localization</a></li>
<li>
<a class="xref" href="chapter-customwidgets.html.en.html" title="Custom Widgets">Custom Widgets</a><div class="autotoc"><ul>
<li><a class="xref" href="sec-custom-containers.html.en.html" title="Custom Containers">Custom Containers</a></li>
<li>Custom Widgets</li>
</ul></div>
</li>
<li><a class="xref" href="chapter-multi-threaded-programs.html.en.html" title="Multi-threaded programs">Multi-threaded programs</a></li>
<li><a class="xref" href="chapter-recommended-techniques.html.en.html" title="Recommended Techniques">Recommended Techniques</a></li>
<li><a class="xref" href="chapter-building-applications.html.en.html" title="Building applications">Building applications</a></li>
<li><a class="xref" href="chapter-contributing.html.en.html" title="Contributing">Contributing</a></li>
<li><a class="xref" href="chapter-refptr.html.en.html" title="The RefPtr smartpointer">The RefPtr smartpointer</a></li>
<li><a class="xref" href="chapter-signals.html.en.html" title="Signals">Signals</a></li>
<li><a class="xref" href="chapter-custom-signals.html.en.html" title="Creating your own signals">Creating your own signals</a></li>
<li><a class="xref" href="sec-signals-comparison.html.en.html" title="Comparison with other signalling systems">Comparison with other signalling systems</a></li>
<li><a class="xref" href="sec-windows-installation.html.en.html" title="gtkmm and Win32"><span class="application">gtkmm</span> and Win32</a></li>
<li><a class="xref" href="chapter-working-with-source.html.en.html" title="Working with gtkmm's Source Code">Working with gtkmm's Source Code</a></li>
<li><a class="xref" href="chapter-wrapping-c-libraries.html.en.html" title="Wrapping C Libraries with gmmproc">Wrapping C Libraries with gmmproc</a></li>
</ul></div>
</li>
</ul></div></div></div>
<div id="footer_art" class="default"> </div>
</div>
<div class="clearfix"></div>
<div id="footer_grass">   </div>
<div id="footer"><div class="container_12">
<div class="links grid_9">
<div class="menu-footer-1-container"><ul id="menu-footer-1" class="menu"><li id="menu-item-88" class="menu-item menu-item-type-custom menu-item-home menu-item-88">
<a href="https://www.gnome.org/">The GNOME Project</a><ul class="sub-menu">
<li id="menu-item-89" class="menu-item menu-item-type-post_type menu-item-89"><a href="https://www.gnome.org/about/">About Us</a></li>
<li id="menu-item-90" class="menu-item menu-item-type-custom menu-item-90"><a href="https://www.gnome.org/get-involved/">Get Involved</a></li>
<li id="menu-item-91" class="menu-item menu-item-type-custom menu-item-91"><a href="https://www.gnome.org/teams/">Teams</a></li>
<li id="menu-item-92" class="menu-item menu-item-type-custom menu-item-92"><a href="https://foundation.gnome.org">The GNOME Foundation</a></li>
<li><a href="https://www.gnome.org/support-gnome/">Support GNOME</a></li>
<li><a href="https://www.gnome.org/contact/">Contact</a></li>
</ul>
</li></ul></div>
<div class="menu-footer-2-container"><ul id="menu-footer-2" class="menu"><li id="menu-item-99" class="menu-item menu-item-type-post_type current-menu-item page_item page-item-20 current_page_item menu-item-99">
<a href="sec-custom-widgets.html.en.html#">Resources</a><ul class="sub-menu">
<li><a href="https://help.gnome.org">Documentation</a></li>
<li><a href="https://wiki.gnome.org">Wiki</a></li>
<li><a href="https://mail.gnome.org/mailman/listinfo">Mailing Lists</a></li>
<li><a href="https://wiki.gnome.org/GnomeIrcChannels">IRC Channels</a></li>
<li><a href="https://gitlab.gnome.org/">Bug Tracker</a></li>
<li><a href="https://gitlab.gnome.org/">Development Code</a></li>
<li><a href="https://wiki.gnome.org/Jhbuild">Build Tool</a></li>
</ul>
</li></ul></div>
<div class="menu-footer-4-container"><ul id="menu-footer-4" class="menu"><li id="menu-item-104" class="menu-item menu-item-type-custom menu-item-104">
<a href="http://www.gnome.org/news/">News</a><ul class="sub-menu">
<li><a href="https://www.gnome.org/start/stable">Latest Release</a></li>
<li><a href="https://planet.gnome.org">Planet GNOME</a></li>
<li><a href="https://news.gnome.org">Development News</a></li>
<li><a href="https://twitter.com/gnome">Twitter</a></li>
</ul>
</li></ul></div>
</div>
<div class="links grid_3 right"><div>
<ul class="menu available_languages"><li>
<strong>This website is available in many languages</strong><ul class="sub-menu"><li><a href="../../languages.html" title="Switching Language">Switch Language</a></li></ul>
</li></ul>
<script type="text/javascript" src="../../js/language.js"></script>
</div></div>
<div id="footnotes" class="grid_9">
                Copyright © 2005‒2014 <strong class="gnome_logo">The GNOME Project</strong><br><small>Optimised for standards. Hosted by <a href="http://redhat.com">Red Hat</a>.</small>
</div>
<div class="clear"></div>
</div></div>
<script type="text/javascript">
$(document).ready(function() {
    // Get browser
    $.each($.browser, function(i) {
        $('body').addClass(i);
        return false;
    });

    // Get OS and add it as class to body tag, this then allows forcing some
    // customisation in the CSS rules.
    var match = navigator.userAgent.toLowerCase().match(/(win|mac|linux)/);
    if (match) {
        $('body').addClass(match[0]);
    }
});
</script><script type="text/javascript">
      var _paq = _paq || [];
      _paq.push(['disableCookies']);
      _paq.push(["trackPageView"]);
      _paq.push(["enableLinkTracking"]);

      (function() {
        var u=(("https:" == document.location.protocol) ? "https" : "http") + "://webstats.gnome.org/";
        _paq.push(["setTrackerUrl", u+"piwik.php"]);
        _paq.push(["setSiteId", "6"]);
        var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
        g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
      })();
    </script>
</body>
</html>
